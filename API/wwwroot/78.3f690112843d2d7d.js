"use strict";(self.webpackChunkClient=self.webpackChunkClient||[]).push([[78],{2078:($,d,c)=>{c.r(d),c.d(d,{StockModule:()=>R});var p=c(6814),v=c(7157),l=c(8109),S=c(8626),h=c(3365),s=c(5313),t=c(9212),m=c(6223),g=c(9862),k=c(5516);let T=(()=>{class o{constructor(e){this.http=e,this.baseUrl=k.N.apiUrl}getSizes(){return this.http.get(this.baseUrl+"sizes")}getProducts(e){let n=new g.LE;return e.brandId>0&&(n=n.append("brandId",e.brandId)),e.typeId>0&&(n=n.append("typeId",e.typeId)),n=n.append("sort",e.sort),n=n.append("pageIndex",e.pageNumber),n=n.append("pageSize",e.pageSize),e.search&&(n=n.append("search",e.search)),this.http.get(this.baseUrl+"stock/products",{params:n})}getStockMovimentation(){return this.http.get(`${this.baseUrl}stock/stock-moviments`)}getStockMovimentationByProduct(e){return this.http.get(`${this.baseUrl}stock/stock-moviments/${e}`)}stockEntry(e,n,i){return this.http.post(`${this.baseUrl}stock/stock-entry`,{productId:e,sizeId:n,quantity:i})}stockOutgoing(e,n,i){return this.http.post(`${this.baseUrl}stock/stock-outgoing`,{productId:e,sizeId:n,quantity:i})}static#t=this.\u0275fac=function(n){return new(n||o)(t.LFG(g.eN))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var y=c(2051),f=c(2296),Z=c(2032),_=c(5683),b=c(8525),M=c(3680);function x(o,a){1&o&&(t.TgZ(0,"th",19)(1,"strong"),t._uU(2,"Id"),t.qZA()())}function N(o,a){if(1&o&&(t.TgZ(0,"td",20)(1,"strong"),t._uU(2),t.qZA()()),2&o){const e=a.$implicit;t.xp6(2),t.hij("# ",e.id,"")}}function w(o,a){1&o&&(t.TgZ(0,"th",19)(1,"strong"),t._uU(2,"Id do Produto"),t.qZA()())}function U(o,a){if(1&o&&(t.TgZ(0,"td",20)(1,"strong"),t._uU(2),t.qZA()()),2&o){const e=a.$implicit;t.xp6(2),t.hij("# ",e.productId,"")}}function A(o,a){1&o&&(t.TgZ(0,"th",19)(1,"strong"),t._uU(2,"Nome do produto"),t.qZA()())}function z(o,a){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(),t.hij(" ",e.productName," ")}}function q(o,a){1&o&&(t.TgZ(0,"th",19)(1,"strong"),t._uU(2,"Tamanho"),t.qZA()())}function I(o,a){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(),t.hij(" ",e.sizeName," ")}}function O(o,a){1&o&&(t.TgZ(0,"th",19)(1,"strong"),t._uU(2,"Quantidade"),t.qZA()())}function F(o,a){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(),t.hij(" ",e.quantity," ")}}function J(o,a){1&o&&(t.TgZ(0,"th",19)(1,"strong"),t._uU(2,"Tipo de Movimento"),t.qZA()())}function P(o,a){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(),t.hij(" ",e.movimentType," ")}}function Q(o,a){1&o&&t._UZ(0,"tr",21)}function D(o,a){1&o&&t._UZ(0,"tr",22)}function Y(o,a){if(1&o&&(t.TgZ(0,"mat-option",39),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(),t.Oqu(e.name)}}function B(o,a){if(1&o&&(t.TgZ(0,"mat-option",39),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(),t.Oqu(e.name)}}function L(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",23)(1,"h2",24),t._uU(2,"Novo Movimento de Entoque"),t.qZA(),t.TgZ(3,"button",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeModal())}),t._uU(4," x "),t.qZA()(),t.TgZ(5,"div",26)(6,"form",27),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSubmit())}),t.TgZ(7,"mat-form-field",28)(8,"mat-label"),t._uU(9,"Produto"),t.qZA(),t.TgZ(10,"mat-select",29),t.NdJ("selectionChange",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.getSizes())}),t.YNc(11,Y,2,2,"mat-option",30),t.qZA()(),t.TgZ(12,"mat-form-field",28)(13,"mat-label"),t._uU(14,"Tamanho"),t.qZA(),t.TgZ(15,"mat-select",31),t.YNc(16,B,2,2,"mat-option",30),t.qZA()(),t.TgZ(17,"mat-form-field",28)(18,"mat-label"),t._uU(19,"Quantidade"),t.qZA(),t._UZ(20,"input",32),t.qZA(),t.TgZ(21,"mat-form-field",28)(22,"mat-label"),t._uU(23,"Tipo de Movimento"),t.qZA(),t.TgZ(24,"mat-select",33)(25,"mat-option",34),t._uU(26,"Entrada"),t.qZA(),t.TgZ(27,"mat-option",35),t._uU(28,"Sa\xedda"),t.qZA()()(),t.TgZ(29,"button",36),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSubmit())}),t._uU(30,"Gravar"),t.qZA()()(),t.TgZ(31,"div",37)(32,"button",38),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeModal())}),t._uU(33,"Fechar"),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(6),t.Q6J("formGroup",e.movimentForm),t.xp6(5),t.Q6J("ngForOf",e.products),t.xp6(5),t.Q6J("ngForOf",e.sizes)}}const E=()=>[10,20,30],G=[{path:"",component:(()=>{class o{constructor(e,n,i,r){this.fb=e,this.stockService=n,this.modalService=i,this.router=r,this.displayedColumns=["id","productId","productName","sizeName","quantity","movimentType"],this.stockMoviments=[],this.dataSource=new s.by(this.stockMoviments),this.shopParams=new S.E,this.totalCount=0,this.products=[],this.sizes=[],this.config={backdrop:!0,ignoreBackdropClick:!1},this.movimentForm=this.createForm()}ngOnInit(){this.getProducts(),this.getSizes(),this.getStockMoviments(),this.dataSource.filterPredicate=(e,n)=>e.sizeName.toLowerCase().includes(n.toLowerCase())||e.productName.toLowerCase().includes(n)&&e.sizeName.toLowerCase()==n||e.productId.toString().includes(n.toLowerCase())||e.id.toString().includes(n.toLowerCase())||e.quantity.toString().includes(n.toLowerCase())||e.movimentType.toLowerCase().includes(n.toLowerCase())}ngAfterViewInit(){this.getStockMoviments()}trackByProductId(e,n){return n.productId}getProducts(){this.stockService.getProducts(this.shopParams).subscribe({next:e=>{this.products=e.data.sort((n,i)=>n.id-i.id),this.shopParams.pageSize=e.pageSize,this.shopParams.pageNumber=e.pageIndex,this.totalCount=e.count},error:e=>console.assert(e)})}getSizes(){this.stockService.getSizes().subscribe(e=>{this.sizes=e})}getStockMoviments(){this.stockService.getStockMovimentation().subscribe(e=>{this.stockMoviments=e,this.dataSource.data=this.stockMoviments,this.dataSource.paginator=this.paginator,console.log(this.dataSource.data)})}applyFilter(){this.dataSource.filter=this.filter.trim().toLowerCase()}onSubmit(){if(this.movimentForm.valid){const e=this.movimentForm.value,n=e.movimentType?.trim().toLowerCase();"entrada"==n&&null!=e.productId&&null!=e.sizeId&&null!=e.quantity&&e.quantity>0?(console.log("entrou"),this.stockService.stockEntry(e.productId,e.sizeId,e.quantity).subscribe(()=>{this.getStockMoviments(),this.closeModal()})):"saida"==n&&null!=e.productId&&null!=e.sizeId&&null!=e.quantity&&e.quantity>0&&this.stockService.stockOutgoing(e.productId,e.sizeId,e.quantity).subscribe(()=>{this.getStockMoviments(),this.closeModal()})}}openModal(e){this.modalRef=this.modalService.show(e,this.config),this.modalRef.onHide?.subscribe(n=>{"backdrop-click"===n&&this.clearEntity()})}closeModal(){this.modalRef.hide(),this.clearEntity()}clearEntity(){this.movimentForm=this.createForm()}createForm(){return this.fb.group({productId:0,sizeId:1,quantity:0,movimentType:""})}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(m.qu),t.Y36(T),t.Y36(y.tT),t.Y36(l.F0))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-types"]],viewQuery:function(n,i){if(1&n&&t.Gf(h.NW,5),2&n){let r;t.iGM(r=t.CRH())&&(i.paginator=r.first)}},decls:34,vars:9,consts:[[1,"container"],[1,"d-flex","justify-content-between"],["mat-flat-button","","color","primary",1,"my-2","btn",3,"click"],["matInput","","type","text","placeholder","Ex: M",1,"filter",3,"ngModel","ngModelChange","keyup"],[1,"table"],[1,"full-width-table",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","class","center-text",4,"matHeaderCellDef"],["mat-cell","","class","center-text",4,"matCellDef"],["matColumnDef","productId"],["matColumnDef","productName"],["matColumnDef","sizeName"],["matColumnDef","quantity"],["matColumnDef","movimentType"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page","showFirstLastButtons","",1,"paginator",3,"pageSize","length","pageSizeOptions"],["paginator",""],["template",""],["mat-header-cell","",1,"center-text"],["mat-cell","",1,"center-text"],["mat-header-row",""],["mat-row",""],[1,"modal-header"],[1,"modal-title"],["mat-icon-button","","aria-label","Close",1,"close",3,"click"],[1,"modal-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],["formControlName","productId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","sizeId"],["matInput","","type","number","formControlName","quantity"],["formControlName","movimentType"],["value","entrada"],["value","saida"],["mat-raised-button","","color","primary","type","submit",3,"click"],[1,"modal-footer"],["mat-button","",3,"click"],[3,"value"]],template:function(n,i){if(1&n){const r=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){t.CHM(r);const u=t.MAs(33);return t.KtG(i.openModal(u))}),t._uU(3,"Novo Movimento de estoque"),t.qZA(),t.TgZ(4,"mat-form-field")(5,"mat-label"),t._uU(6,"Filtro"),t.qZA(),t.TgZ(7,"input",3),t.NdJ("ngModelChange",function(u){return i.filter=u})("keyup",function(){return i.applyFilter()}),t.qZA()()(),t.TgZ(8,"div",4)(9,"mat-table",5),t.ynx(10,6),t.YNc(11,x,3,0,"th",7)(12,N,3,1,"td",8),t.BQk(),t.ynx(13,9),t.YNc(14,w,3,0,"th",7)(15,U,3,1,"td",8),t.BQk(),t.ynx(16,10),t.YNc(17,A,3,0,"th",7)(18,z,2,1,"td",8),t.BQk(),t.ynx(19,11),t.YNc(20,q,3,0,"th",7)(21,I,2,1,"td",8),t.BQk(),t.ynx(22,12),t.YNc(23,O,3,0,"th",7)(24,F,2,1,"td",8),t.BQk(),t.ynx(25,13),t.YNc(26,J,3,0,"th",7)(27,P,2,1,"td",8),t.BQk(),t.YNc(28,Q,1,0,"tr",14)(29,D,1,0,"tr",15),t.qZA(),t._UZ(30,"mat-paginator",16,17),t.qZA(),t.YNc(32,L,34,3,"ng-template",null,18,t.W1O),t.qZA()}2&n&&(t.xp6(7),t.Q6J("ngModel",i.filter),t.xp6(2),t.Q6J("dataSource",i.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(),t.Q6J("pageSize",10)("length",i.dataSource.data.length)("pageSizeOptions",t.DdM(8,E)))},dependencies:[p.sg,m._Y,m.Fj,m.wV,m.JJ,m.JL,m.sg,m.u,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,h.NW,f.lW,f.RK,Z.Nt,_.KE,_.hX,b.gD,M.ey,m.On],styles:['@charset "UTF-8";.full-width-table[_ngcontent-%COMP%]{width:1000px}.full-width-table[_ngcontent-%COMP%]   .mat-column-id[_ngcontent-%COMP%], .full-width-table[_ngcontent-%COMP%]   .mat-column-productId[_ngcontent-%COMP%], .full-width-table[_ngcontent-%COMP%]   .mat-column-productName[_ngcontent-%COMP%], .full-width-table[_ngcontent-%COMP%]   .mat-column-sizeName[_ngcontent-%COMP%], .full-width-table[_ngcontent-%COMP%]   .mat-column-quantity[_ngcontent-%COMP%], .full-width-table[_ngcontent-%COMP%]   .mat-column-movimentType[_ngcontent-%COMP%]{width:16.66%}.center-text[_ngcontent-%COMP%]{text-align:center}.wide-table[_ngcontent-%COMP%]{width:100%}.btn[_ngcontent-%COMP%]{height:3rem!important}']})}return o})()},{path:"**",redirectTo:"",pathMatch:"full"}];let H=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[l.Bz.forChild(G),l.Bz]})}return o})(),R=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[p.ez,v.m,m.u5,H]})}return o})()}}]);